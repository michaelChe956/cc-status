# cc-statusline 一键安装指南

**版本**: v1.0
**日期**: 2026-01-28

## 快速开始

### 方法 1: 使用 uvx（推荐，发布后）

```bash
# 一键安装
uvx cc-statusline install

# 重启 Claude Code
claude
```

### 方法 2: 本地开发环境

```bash
# 安装项目
cd cc-statusline
uv venv && source .venv/bin/activate
uv pip install -e ".[dev]"

# 安装到 Claude Code
python -m cc_statusline install

# 重启 Claude Code
claude
```

## 命令说明

### install - 安装状态栏配置

```bash
# 基础安装（使用默认设置）
cc-statusline install

# 自定义主题和刷新间隔
cc-statusline install --theme modern --interval 5000

# 强制覆盖现有配置
cc-statusline install --force
```

**参数**:
- `--theme THEME`: 指定主题（默认: modern）
- `--interval MS`: 刷新间隔，单位毫秒（默认: 10000）
- `--force`: 强制覆盖现有配置

### uninstall - 卸载状态栏配置

```bash
# 移除配置
cc-statusline uninstall
```

**说明**:
- 自动备份原配置
- 只移除 statusLine 字段
- 保留其他配置不变

### verify - 验证配置

```bash
# 检查配置是否有效
cc-statusline verify
```

**输出示例**:
```
✅ 状态栏配置有效
{
  "type": "command",
  "command": "uvx cc-statusline --once",
  "refreshInterval": 10000,
  "padding": 0
}
```

## 配置详解

### 配置文件位置

`~/.claude/settings.json`

### 配置内容示例

```json
{
  "statusLine": {
    "type": "command",
    "command": "uvx cc-statusline --once --theme modern",
    "refreshInterval": 10000,
    "padding": 0
  }
}
```

**字段说明**:
- `type`: 固定为 "command"
- `command`: 执行命令（自动检测最佳路径）
- `refreshInterval`: 刷新间隔（毫秒）
- `padding`: 内边距（像素）

### 自动检测命令优先级

安装器会按以下优先级检测可用命令:

1. `uvx cc-statusline` (最高优先级)
2. `cc-statusline` (全局安装)
3. `python -m cc_statusline` (本地虚拟环境)

## 自动备份

每次修改配置前，安装器会自动备份原配置:

**备份文件名格式**: `settings.json.backup.YYYYMMDD_HHMMSS`

**位置**: `~/.claude/`

**示例**: `settings.json.backup.20260128_165343`

## 故障排除

### 问题 1: 命令未找到

**错误信息**:
```
❌ 错误: 无法检测到 cc-statusline 命令
```

**解决方法**:
```bash
# 确保已安装 cc-statusline
pip install cc-statusline

# 或使用 uvx
uvx cc-statusline install
```

### 问题 2: 配置已存在

**输出**:
```
⚠️  状态栏配置已存在
使用 --force 强制覆盖
```

**解决方法**:
```bash
# 使用 --force 强制覆盖
cc-statusline install --force
```

### 问题 3: 配置文件格式错误

**输出**:
```
⚠️  配置文件格式错误: /Users/.../.claude/settings.json
```

**解决方法**:
1. 检查配置文件 JSON 格式是否正确
2. 从备份恢复配置
3. 删除配置文件重新安装

## 高级用法

### 使用不同主题

```bash
# 列出可用主题
cc-statusline --list-themes

# 安装指定主题
cc-statusline install --theme THEME_NAME
```

### 调整刷新频率

```bash
# 更快刷新（5 秒）
cc-statusline install --interval 5000

# 更慢刷新（30 秒）
cc-statusline install --interval 30000
```

### 手动修改配置

如需手动调整配置，直接编辑 `~/.claude/settings.json`:

```json
{
  "statusLine": {
    "command": "uvx cc-statusline --once --theme YOUR_THEME",
    "refreshInterval": YOUR_INTERVAL
  }
}
```

修改后重启 Claude Code 生效。

## 完整工作流示例

### 初次安装

```bash
# 1. 安装（使用 modern 主题，10 秒刷新）
uvx cc-statusline install --theme modern --interval 10000

# 2. 验证配置
uvx cc-statusline verify

# 3. 重启 Claude Code
claude
```

### 更换主题

```bash
# 1. 重新安装（强制覆盖）
uvx cc-statusline install --theme minimalist --force

# 2. 重启 Claude Code
claude
```

### 卸载

```bash
# 1. 卸载配置
uvx cc-statusline uninstall

# 2. 重启 Claude Code
claude
```

## 相关链接

- [项目仓库](https://github.com/your/cc-statusline)
- [问题反馈](https://github.com/your/cc-statusline/issues)
- [主题开发指南](./theme-development.md)

---

**提示**: 所有配置修改后都需要重启 Claude Code 才能生效！
